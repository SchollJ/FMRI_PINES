{"title":"Visual Reports MRIQC Unprocessed BOLD data + small intro","markdown":{"headingText":"Visual Reports MRIQC Unprocessed BOLD data + small intro","containsRefs":false,"markdown":"\n## Intro and Glossary\n\nIn this document we will try to build a document on how to visually inspect the MRIQC and fMRIPrep visual outputs.\n\nFor this are going to use several resources:\n\n**Main Resource** will be the paper that these notes are attached to --> ([Provins et al., 2023](zotero://select/library/items/KSI3K2X5))\n\n**But also see:**\n\n- [https://www.youtube.com/watch?v=In6Dez_uuxQ&t=1s](https://www.youtube.com/watch?v=In6Dez_uuxQ&t=1s) --> video toturial on youtube on how to set up and interpret fmriqc by Matt Defenderfer of UAB research computing\n- [https://sarenseeley.github.io/BIDS-fmriprep-MRIQC.html#Usage30](https://sarenseeley.github.io/BIDS-fmriprep-MRIQC.html#Usage30) --> Very helpful and well structured notes (main inspiration for this document) from Saren Seeley on BIDS, FMRIQC and fmriprep\n- [https://docs.google.com/document/d/1TE6ZWzNg8cDpvL4Vu0VGOZQLXkQ88Fa59AORzN01Avk/edit](https://docs.google.com/document/d/1TE6ZWzNg8cDpvL4Vu0VGOZQLXkQ88Fa59AORzN01Avk/edit) --> google doc produced by Saren Seeley on how to read fmriprep output with the contribution of Oscar Esteban\n- ([Provins et al., 2022](zotero://select/library/items/BEMZKYK7)) --> interpretation of the extended carpet plot in fmriprep and fmriqc + corresponding nuisance regressor\n\n### Quality assessment (QA):\n\n- Focuses on ensuring the research workflow produces data of “sufficient quality” (e.g identifying a structures artifact caused by an environmental condition that can be actioned upon so that **it doesn’t replicate prospectively in future acquisitions).**\n\n### Quality control (QC):\n\n- **Excludes poor-quality data from the dataset** so that they do not continue through the research workflow and potentially bias the results\n\n\\--> QA/QC checkpoints are mostly unstandardized and typically involve the screening of the images one by one.\n\n\\--> **Raters:** individual researchers that repeatedly screening data\n\n## Methods\n\n- Assessing the unprocessed data using the MRIQC visual reports\n- Assess the results with minimal preprocessing using hte fMRIPrep visual reports.\n\n### Assessment of quality aspects and exclusion criteria\n\n- All based on the visual inspection of the individual MRIQCC and fMRIPrep eports, so they are all qualitative.\n\n# Exclusion criteria for unprocessed BOLD data assessed with MRIQC visual reports\n\n**Note:** “The artifact yielding exclusion are pointed using red arrows, while the artifact not yielding exclusion are pointed using green arrows.” ([Provins et al., 2023, p. 1](zotero://select/library/items/KSI3K2X5)) ([pdf](zotero://open-pdf/library/items/WMHQS3TB?page=1))\n\n- **Artifactual structures in the Background**\n    \n    \\--> **Because no BOLD signal originates from the air surrounding the head, the background should not contain visible structures.**\n    \n    However, signal can spill into the background through several imaging processes:\n    \n    - Aliasing ghosts (see below)\n    - Spillover originating from moving and blinking eyes\n    - Bulkhead motion\n\n      -->> **Where to find:**\n\n                        1) **Background noise panel**\n\n                        2) Standard deviation map view\n\n    **\\--> What to look for:**\n\n[image]\n\n- **Susceptibility distortion artifacts**\n    \n    **\\-->** **Caused by B0 field non-uniformity**.\n    \n    - Inserting an object in the scanner perturbs the nominal B0 field, which should be constant all across the FoV\n    - Tissue boundaries produce steps of deviation from the nominal B0 field, which are **larger where the air is close to tissues**\n    - The signal is slightly diplaced from the sampling grid along the phase encoding axis leading to susceptibility distortions.\n    \n    **\\--> Where to find:**  \n    \n                                 **On the BOLD average panel**\n    \n          --> In two different ways\n    \n    1. **As a signal drop out - that is a region where the signal vanishes**\n        \n        \\-- Signal drop - outs often apper close to the brain - air interfaces\n        \n        1. Ventromedial prefrontal cortex\n        2. Anterior part of the prefrontal cortex\n        3. Region next to ear cavities\n    2. **As brain distortions**\n\n       **\\--> What to do to correct:**  can by corrected by the susceptibility distortion correction implemented in FMRIPrep as long there is as a **corresponding filed map**\n\n                            --> Therefore, susceptibility distortions does not necessarily mean an exclusion criteria\n\n    **\\--> What to look for:**\n\n    [image]\n\n-     **Aliasing ghosts**\n    \n    **\\--> A ghost is a type of structured noise that appears as shifted and faintly repeated versions of the main object, usually in hte phase encoding direction.**\n    \n\n     --> For several reasons:\n\n                \\-- signal instability between pulse cycle repetitions\n\n                \\-- the particular strategy of echo-planar imaging to record the k-space during acquisition\n\n         --> Often exacerbated by whithin-volume had motion.\n\n**\\--> Where to find:**  \n\n                **1) In the background noise visualisation**\n\n                2) Bold average view\n\n**\\--> What to look for:**\n\n[image]\n\n[image]\n\n**Important Tip: Increase the screen’s brightness as low brightness makes this artifact harder to see!**\n\n- **Wrap-around**\n    \n    **\\--> Whenever the object’s dimensions exceed the defined field-of-view (FOV).**\n    \n    - It is visibe as a piece of the head (usually the skull) being folded over on the opposite extreme of the image\n    - Exclude subjects based on the observation of a wrap-around only if the folded region contained or overlapped in the cortex.\n\n**\\--> Where to find:**  \n\n                              1) Background noise visualisation --> The clearest\n\n                   2) BOLD average\n\n                              3)  Standard deviation map\n\n**\\--> What to look for:**\n\n[image]\n\n**Important Tip: Increase the screen’s brightness as low brightness makes this artifact harder to see!**\n\n- **Assessment of the time series with the carpet plot**\n    \n    \\--> Carpet plot is a tool to **visualise changes in volel intensity** throughout an fMRI scan.  The idea is to **plot voxel time series in close spatial proximity so that the eye notes temporal coincidence.**\n    \n\n      -->  Both in MRIQC and fMRIPrep\n\n    **\\--> Crown area:** correspond’s to voxels located on a closed band around the brain’s outer edge. As those voxels are outside the brain, we do not expect any signal there, meaning that if some signal is observed, we can interpret it as artifactual.\n\n            **\\--> A strongly structured crown region in the carpet plot is a sign that the artifacts are compromising the fmri scanner.**\n\n            Could be due to:\n\n                            1) motion picks\n\n                            2) periodic motion (e.g. respiration)\n\n                            3) coil failure\n\n                            4) drift of unknown source\n\n            \\--> Finding temporal patterns similar in gray matter areas and simultaneously in regions of no interest (for instance, cerebrospinal fluid or the crown) indicates the presence of artifacts, typically derived from head motion.\n\n                            If the planned analysis specifies noise regression techniques based on information from these regions of no interest [which is standard and recommended (Ciric et al., 2017)], the risk of removing signals with neural origins is high, and affected scans should be excluded.” ([Provins et al., 2023, p. 5](zotero://select/library/items/KSI3K2X5))\n\n**\\--> What to look for:**\n\n               [image]\n\n- **Hyperintensity of single slices**\n    \n    \\--> Several time series to support the interpretation of the carpet\n    \n    **\\--> The slice-wise z-standardized signal average is useful for detecting sudden “spikes” in the average intensity of singel slices of BOLD scans**\n    \n    - When paired with the motion traces, it is possible to determine whether these spikes are caused by:\n        \n        - **motion** --> Spikes caused by motion typically **affect several or all slices**\n        - or by possible **problems with the scanner** (e.g. white-pixel noise) --> Spikes caused by **white - pixel noise affect only one slice and are generally more acute**\n    - White-pixel noise is generally caused by some small pieces of metal in the scan room or a loose screw on the scanner that accumulates energy and then discharges randomly.In the image domain, it manifests as an abrupt signal intensity change in one slice at one time point.\n    - **For resting-state data, you discard BOLD scans containing these spikes regardless of their physical origin (motion vs. white-pixel noise) because correlation analyses are likely biased by such peaks. Task data analyses are typically more robust to this particular artifact.**\n\n**\\--> What to look for:**\n\n[image]\n\n- **Vertical strikes in the sagittal plane of the standard deviation map**\n    \n    - The sagittal view of the sd map might show vertical strike patterns that extend hyperintensities through the whole sagittal plan\n    - Exclude all images that showcase these patterns\n\n**\\--> What to look for:**\n\n[image]\n\n- **Data formatting issues**\n    \n    \\--> Such mistakes result in the brain image not being correctly visualized and preprocessed, with axes either being flipped (e.g. the anterior part of the brain is labeled as posterior) or switched (e.g. axial slices are interpreted as coronal ones).\n    \n\n**Examples:**\n\n[image]\n\n**Other important notes**\n\n1. MRIQC --> Visual Reports --> **Bold average:** It gives you the Bold average, so it’s averaging all the volumes together and presenting them as this slices through that average.\n    \n    **\\--> What are you looking for is in the main area of the brain to see a high contrast between grey and white matter**  \n    **BUT: Note that these images are not preprossessed so there is no distortion correction! So in an AP image as the one below if you see some smooshing at the front and some extension at the back that’s completely normal** ([“Introduction to MRIQC [TRAIN-05-2022]”, 2022](zotero://select/library/items/GBRPHHIX))\n    \n    **Example:** (AP image)\n    \n    [image]\n    \n\n    **2\\. Standard deviation map:** what is **the spread of the value of all of the voxels over the entire time course**\n\n        e.g. : When you are looking to at the sd of voxels that correspond to the eyes, these have high sd because the are constantly moving so the values are going to have a high spread.\n\n[image]\n\n**\\--> But when you are in the brain what you want are low sd values!**\n\n    Also, you do get areas of high sd:\n\n        \\- along the edges of the brain (due to slight movement that causes these voxels to have brain or CSF or skull or empty space)  \n\n        \\- and in some of the major blood vessels that go through the brain  \n\n        [image]\n\n**3\\. Framewise Displacement (FD) [mm]:** the absolute distance after motion that the brain moved from the beginning reference image (but note that no actual motion correction is saved at this point).\n\n\\--> 0.2 mm cut -off, you get an idea on how many volumes when beyond this cut-off point, **note** that this is a pretty stringent cut-off score for FD\n\n**Example:**\n\n[image]","srcMarkdownNoYaml":""},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../styles.css"],"toc":true,"output-file":"Visual Reports MRIQC Unprocessed BOLD data + small intro.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.5.57","theme":"cosmo"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}